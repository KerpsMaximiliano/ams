<div class="dialog-title" [tabIndex]="0">
  <h2> {{ data.title | uppercase }} </h2>
</div>

<div class="dialog-content">
  <form class="form-datos" [formGroup]="formGroup">
    <mat-tab-group [selectedIndex]="activeTabIndex" (selectedTabChange)="tabChanged($event)" mat-stretch-tabs
      dynamicHeight>
      <mat-tab>
        <div class="seeker-fields-container mt-1">
          <h3> CÓDIGO </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <input matInput formControlName="codigo" placeholder="Ingrese un codigo." required minlength="1"
              maxlength="2">
            <mat-error *ngIf="formGroup.get('codigo')?.invalid && formGroup.get('codigo')?.touched">
              {{ getErrorMessage(formGroup.get('codigo')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> FORMA DE PAGO </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <mat-select formControlName="forma_pago" placeholder="Seleccione una forma de pago." required minlength="1"
              maxlength="3" disableOptionCentering>
              <mat-option [value]="'BSF'"> BSF - Débitos Automáticos NBSF </mat-option>
              <mat-option [value]="'LNK'"> LNK - Pagos RED LINK </mat-option>
              <mat-option [value]="'CBU'"> CBU - Transferencias a distintos bancos </mat-option>
              <mat-option [value]="'TC '"> TC - Tarjetas de crédito a configurar </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('forma_pago')?.invalid && formGroup.get('forma_pago')?.touched">
              {{ getErrorMessage(formGroup.get('forma_pago')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> BANCO </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <ng-container *ngIf="this.data.par_modo === 'C'; else isView">
              <mat-select formControlName="codigo_banco"
                [placeholder]="formGroup.get('forma_pago')?.value === 'TC ' ? 'No requiere un banco.' : 'Seleccione una forma de pago.'"
                required minlength="1" maxlength="3" disableOptionCentering>
                <ng-container *ngIf="formGroup.get('forma_pago')?.value !== 'CBU'">
                  <mat-option [value]="330"> Nuevo Banco de Santa Fe </mat-option>
                  <mat-option [value]="815"> Pagos RED LINK </mat-option>
                  <mat-option [value]="0"> Tarjeta de Crédito </mat-option>
                </ng-container>
                <div *ngFor="let bank of banks">
                  <mat-option [value]="bank.codigo"> {{ bank.description }} </mat-option>
                </div>
              </mat-select>
            </ng-container>
            <mat-error *ngIf="formGroup.get('codigo_banco')?.invalid && formGroup.get('codigo_banco')?.touched">
              {{ getErrorMessage(formGroup.get('codigo_banco')) }}
            </mat-error>
            <ng-template #isView>
              <input matInput [value]="data.descripcion_banco" disabled />
            </ng-template>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> DESCRIPCIÓN </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <input matInput formControlName="description" placeholder="Ingrese una descripción." required minlength="3"
              maxlength="20">
            <mat-error *ngIf="formGroup.get('description')?.invalid && formGroup.get('description')?.touched">
              {{ getErrorMessage(formGroup.get('description')) }}
            </mat-error>
          </mat-form-field>
        </div>
      </mat-tab>

      <mat-tab>
        <div class="seeker-fields-container mt-1">
          <h3> NEMOTÉCNICO </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <input matInput formControlName="nombre_tarjeta_nemot" placeholder="Ingrese un nemotécnico. " required
              minlength="1" maxlength="5">
            <mat-error
              *ngIf="formGroup.get('nombre_tarjeta_nemot')?.invalid && formGroup.get('nombre_tarjeta_nemot')?.touched">
              {{ getErrorMessage(formGroup.get('nombre_tarjeta_nemot')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> ¿TRABAJA CON ARCHIVOS? </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <mat-select formControlName="trabaja_archivos" placeholder="Seleccione una opción." required minlength="1"
              maxlength="3" disableOptionCentering>
              <mat-option [value]="'S'"> SI </mat-option>
              <mat-option [value]="'N'"> NO </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('trabaja_archivos')?.invalid && formGroup.get('trabaja_archivos')?.touched">
              {{ getErrorMessage(formGroup.get('trabaja_archivos')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> ¿TRABAJA CON RECHAZOS? </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <mat-select formControlName="trabaja_rechazos" placeholder="Seleccione una opción." required minlength="1"
              maxlength="1" disableOptionCentering>
              <mat-option [value]="'S'"> SI </mat-option>
              <mat-option [value]="'N'"> NO </mat-option>
            </mat-select>
            <mat-error *ngIf="formGroup.get('trabaja_rechazos')?.invalid && formGroup.get('trabaja_rechazos')?.touched">
              {{ getErrorMessage(formGroup.get('trabaja_rechazos')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <div class="seeker-fields-container">
          <h3> ¿SOLICITA DATOS ADICIONALES? </h3>
          <mat-form-field class="seeker-form-field" appearance="outline">
            <mat-select formControlName="solicita_datos_ad" placeholder="Seleccione una opción." required minlength="1"
              maxlength="1" disableOptionCentering>
              <mat-option [value]="'S'"> SI </mat-option>
              <mat-option [value]="'N'"> NO </mat-option>
            </mat-select>
            <mat-error
              *ngIf="formGroup.get('solicita_datos_ad')?.invalid && formGroup.get('solicita_datos_ad')?.touched">
              {{ getErrorMessage(formGroup.get('solicita_datos_ad')) }}
            </mat-error>
          </mat-form-field>
        </div>

        <ng-container *ngIf="data.par_modo === 'R' || data.par_modo === 'U'">
          <div class="seeker-fields-container">
            <h3> ESTADO </h3>
            <mat-form-field class="seeker-form-field" appearance="outline">
              <input matInput [value]="data.codigo_tarjeta_de_baja === 'S' ? 'BAJA' : 'ACTIVO'" disabled>
              <mat-error
                *ngIf="formGroup.get('codigo_tarjeta_de_baja')?.invalid && formGroup.get('codigo_tarjeta_de_baja')?.touched">
                {{ getErrorMessage(formGroup.get('codigo_tarjeta_de_baja')) }}
              </mat-error>
            </mat-form-field>
          </div>
        </ng-container>
      </mat-tab>
    </mat-tab-group>

    <div *ngIf="data.edit; else other_content" class="buttons-container">
      <button class="primary-button icon-button" type="button" mat-dialog-close>
        <mat-icon> close </mat-icon>
        Cancelar
      </button>
      <button class="primary-button icon-button" type="button" [disabled]="activeTabIndex === 0" (click)="prevStep()">
        <mat-icon> arrow_back_ios </mat-icon>
        Anterior
      </button>
      <div *ngIf="data.par_modo === 'U'">
        <button [class]="formGroup.invalid ? 'primary-button icon-button disabled' : 'primary-button icon-button'"
          type="button" (click)="changeStatus()" *ngIf="this.data.par_modo === 'U'">
          <mat-icon> {{ this.data.codigo_tarjeta_de_baja === 'S'? 'done_all' : 'remove_done' }} </mat-icon>
          {{ data.codigo_tarjeta_de_baja === 'S' ? 'Alta' : 'Baja' }}
        </button>
      </div>
      <button class="primary-button icon-button" type="button" [disabled]="activeTabIndex === 1" (click)="nextStep()">
        <mat-icon> arrow_forward_ios </mat-icon>
        Siguiente
      </button>
      <button [class]="formGroup.invalid ? 'primary-button icon-button disabled' : 'primary-button icon-button'"
        type="submit" (click)="confirm()">
        <mat-icon> done </mat-icon>
        Guardar
      </button>
    </div>

    <ng-template #other_content>
      <div class="buttons-container">
        <button class="primary-button icon-button" mat-dialog-close>
          <mat-icon> done </mat-icon>
          Aceptar
        </button>
        <button class="primary-button icon-button" type="button" [disabled]="activeTabIndex === 0" (click)="prevStep()">
          <mat-icon> arrow_back_ios </mat-icon>
          Anterior
        </button>
        <button class="primary-button icon-button" type="button" [disabled]="activeTabIndex === 1" (click)="nextStep()">
          <mat-icon> arrow_forward_ios </mat-icon>
          Siguiente
        </button>
      </div>
    </ng-template>
  </form>
</div>